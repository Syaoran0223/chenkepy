<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>思明试卷情报系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{$=url_for('static', filename='css/bootstrap-3.3.6.min.css')}">
    <script src="{$=url_for('static', filename="public/static/jquery.min.js")}"></script>
</head>
<body>
<div class="container">
    <div class="page-header">
      <h4 style="color: #337AB7">请完善信息完成注册</h4>
    </div>
    <div class="col-sm-6 col-sm-offset-3">
        <div class="panel panel-default">
          <div class="panel-body">
            <form class="form-horizontal" role="form">
              <div class="form-group">
                <label for="phone" class="col-sm-3 control-label">手机号</label>
                <div class="col-sm-8">
                  <p class="form-control-static">{$=session.phone}</p>
                </div>
              </div>
              <div class="form-group">
                <label for="userName" class="col-sm-3 control-label">用户名</label>
                <div class="col-sm-8">
                  <input type="text" class="form-control" id="userName" placeholder="用户名">
                </div>
              </div>
              <div class="form-group">
                <label for="password" class="col-sm-3 control-label">密码</label>
                <div class="col-sm-8">
                  <input type="password" class="form-control" id="password" placeholder="密码">
                </div>
              </div>
              <div class="form-group">
                <label for="repassword" class="col-sm-3 control-label">确认密码</label>
                <div class="col-sm-8">
                  <input type="password" class="form-control" id="repassword" placeholder="确认密码">
                </div>
              </div>
              <div class="form-group">
                <label for="email" class="col-sm-3 control-label">邮箱</label>
                <div class="col-sm-8">
                  <input type="email" class="form-control" id="email" placeholder="邮箱">
                </div>
              </div>
              <div class="selectList">
                <div class="form-group">
                  <label for="province" class="col-sm-3 control-label">所在城市</label>
                  <div class="col-sm-8">
                    <select class="form-control" id="province">
                      <option>请选择</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label for="province" class="col-sm-3 control-label"></label>
                  <div class="col-sm-8">
                    <select class="form-control" id="city">
                      <option>请选择</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label for="province" class="col-sm-3 control-label"></label>
                  <div class="col-sm-8">
                    <select class="form-control" id="area">
                      <option>请选择</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label for="school" class="col-sm-3 control-label">学校</label>
                  <div class="col-sm-8">
                    <select class="form-control" id="school">
                      <option>请选择</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label for="grade" class="col-sm-3 control-label">年级</label>
                <div class="col-sm-8">
                  <select class="form-control">
                      <option>1</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5</option>
                  </select>
                </div>
              </div>
            </form>
          </div>
        </div>
    </div>
    <div class="col-sm-6 col-sm-offset-3 text-right">
        <button class="btn btn-warning"><span class="glyphicon glyphicon-chevron-left"></span> 上一步</button>
        <button class="btn btn-primary">&nbsp;&nbsp;保存&nbsp;&nbsp;</button>
    </div>
    <script type="text/javascript">
      $(function(){
          $(".selectList").each(function(){
              var temp_html;
              var oProvince = $(this).find("#province");
              var oCity = $(this).find("#city");
              var oArea = $(this).find("#area");
              var oSchool = $(this).find('#school')
              //初始化省
              var province = function(){
                  var provinces;
                  var temp_html = '<option>请选择</option>';
                  $.getJSON('/api/province/', {}, function(data) {
                      provinces = data.data
                      $.each(provinces, function(i,province){
                          temp_html+="<option value='"+province.id+"'>"+province.name+"</option>";
                      });
                      oProvince.html(temp_html);
                  })
              };
              //赋值市
              var city = function(){
                  var temp_html = '<option>请选择</option>';
                  var cities;
                  var pro_id = oProvince.val()
                  $.getJSON('/api/city/', {pro_id: pro_id}, function(data) {
                      cities = data.data
                      $.each(cities, function(i,city){
                          temp_html+="<option value='"+city.id+"'>"+city.name+"</option>";
                      });
                      oCity.html(temp_html);
                  })
              };
              //赋值县
              var area = function(){
                  var temp_html = '<option>请选择</option>';
                  var areas;
                  var city_id = oCity.val();
                  $.getJSON('/api/area/', {city_id: city_id}, function(data) {
                      areas = data.data
                      $.each(areas, function(i,area){
                          temp_html+="<option value='"+area.id+"'>"+area.name+"</option>";
                      });
                      oArea.html(temp_html);
                  })
              };

              //学校
              var school = function() {
                var temp_html = '<option>请选择</option>';
                var schools;
                var ctid = oArea.val();
                $.getJSON('/api/school/', {ctid: ctid}, function(data) {
                    schools = data.data
                    $.each(schools, function(i,school){
                        temp_html+="<option value='"+school.id+"'>"+school.name+"</option>";
                    });
                    oSchool.html(temp_html);
                })
              }

              //选择省改变市
              oProvince.change(function(){
                  city();
              });
              //选择市改变县
              oCity.change(function(){
                  area();
              });
              oArea.change(function() {
                  school();
              })
              province();
          });
      });
    </script>
</div>
</body>
</html>
